<UserControl
    x:Class="Floozys_Hotel.Views.BookingOverviewView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Floozys_Hotel.Converters"
    xmlns:core="clr-namespace:Floozys_Hotel.Core"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Floozys_Hotel.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DesignHeight="600"
    d:DesignWidth="1000"
    mc:Ignorable="d">

    <UserControl.Resources>
        <core:BindingProxy x:Key="DataContextProxy" Data="{Binding}" />

        <converters:BookingLeftMarginConverter x:Key="BookingLeftMarginConverter" />
        <converters:BookingWidthConverter x:Key="BookingWidthConverter" />
        <converters:RoomBookingsConverter x:Key="RoomBookingsConverter" />
        <converters:DateHeaderConverter x:Key="DateHeaderConverter" />
        <converters:BookingStatusColorConverter x:Key="BookingStatusColorConverter" />
        <converters:CheckInStatusConverter x:Key="CheckInStatusConverter" />
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="300" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <TextBlock
            Grid.Row="0"
            Grid.Column="0"
            Margin="0,0,0,30"
            VerticalAlignment="Center"
            FontSize="30"
            FontWeight="ExtraBold"
            Text="Booking Overview" />

        <Button
            Grid.Row="0"
            Grid.Column="2"
            Width="180"
            Height="50"
            Margin="0,0,0,30"
            HorizontalAlignment="Right"
            Background="#90EE90"
            BorderBrush="#32CD32"
            BorderThickness="2"
            Command="{Binding NewBookingCommand}"
            Content="New booking"
            FontSize="16"
            FontWeight="SemiBold"
            Foreground="Black" />

        <!--  Calendar  -->
        <Border
            Grid.Row="1"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="0,0,20,0"
            BorderBrush="LightGray"
            BorderThickness="1">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Controls  -->
                <Grid Grid.Row="0" Margin="15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBox
                        Grid.Column="0"
                        Width="200"
                        Height="35"
                        Padding="10,0"
                        VerticalContentAlignment="Center"
                        FontSize="14"
                        Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Setter Property="Foreground" Value="Black" />
                                <Style.Triggers>
                                    <Trigger Property="Text" Value="">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <VisualBrush
                                                    AlignmentX="Left"
                                                    AlignmentY="Center"
                                                    Stretch="None">
                                                    <VisualBrush.Visual>
                                                        <TextBlock
                                                            Margin="10,0,0,0"
                                                            Foreground="Gray"
                                                            Text="🔍 Search by Guest..." />
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <StackPanel
                        Grid.Column="1"
                        HorizontalAlignment="Center"
                        Orientation="Horizontal">
                        <Button
                            Width="30"
                            Height="30"
                            Margin="0,0,10,0"
                            Command="{Binding PreviousMonthCommand}"
                            Content="&lt;"
                            FontSize="16" />
                        <TextBlock
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="SemiBold"
                            Text="{Binding CurrentMonthDisplay}" />
                        <Button
                            Width="30"
                            Height="30"
                            Margin="10,0,0,0"
                            Command="{Binding NextMonthCommand}"
                            Content="&gt;"
                            FontSize="16" />
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button
                            Width="60"
                            Height="30"
                            Margin="0,0,2,0"
                            Command="{Binding SetWeekViewCommand}"
                            Content="Week">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Week">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="Background" Value="#E0E0E0" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button
                            Width="60"
                            Height="30"
                            Margin="0,0,2,0"
                            Command="{Binding SetMonthViewCommand}"
                            Content="Month">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Month">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="Background" Value="#E0E0E0" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button
                            Width="60"
                            Height="30"
                            Command="{Binding SetYearViewCommand}"
                            Content="Year">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="Background" Value="#E0E0E0" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Grid>

                <!--  Content  -->
                <Grid Grid.Row="1">
                    <!--  Calendar View  -->
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                        <ScrollViewer.Style>
                            <Style TargetType="ScrollViewer">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ScrollViewer.Style>

                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!--  Room Header  -->
                            <Border
                                Grid.Row="0"
                                Grid.Column="0"
                                Height="30"
                                Background="#F0F0F0"
                                BorderBrush="Gray"
                                BorderThickness="0,0,1,1">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontWeight="Bold"
                                    Text="Rooms" />
                            </Border>

                            <!--  Days Header  -->
                            <ItemsControl
                                Grid.Row="0"
                                Grid.Column="1"
                                ItemsSource="{Binding DaysInMonth}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Rows="1" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Height="30"
                                            Background="White"
                                            BorderBrush="LightGray"
                                            BorderThickness="0,0,1,1">
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Text="{Binding}" />
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!--  Rooms  -->
                            <ItemsControl
                                Grid.Row="1"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                ItemsSource="{Binding Rooms}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="150" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="50" />
                                            </Grid.RowDefinitions>

                                            <Border
                                                Grid.Column="0"
                                                Background="White"
                                                BorderBrush="LightGray"
                                                BorderThickness="0,0,1,1">
                                                <StackPanel Margin="10,0" VerticalAlignment="Center">
                                                    <TextBlock FontWeight="Bold" Text="{Binding RoomNumber}" />
                                                    <TextBlock
                                                        FontSize="10"
                                                        Foreground="Gray"
                                                        Text="{Binding RoomSize}" />
                                                </StackPanel>
                                            </Border>

                                            <Border
                                                x:Name="TimelineBorder"
                                                Grid.Column="1"
                                                BorderBrush="LightGray"
                                                BorderThickness="0,0,0,1">
                                                <Grid>
                                                    <!--  Background Grid Lines  -->
                                                    <ItemsControl ItemsSource="{Binding DataContext.DaysInMonth, RelativeSource={RelativeSource AncestorType=UserControl}}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border
                                                                    Height="50"
                                                                    BorderBrush="#F5F5F5"
                                                                    BorderThickness="0,0,1,0" />
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!--  Bookings Layer  -->
                                                    <ItemsControl>
                                                        <ItemsControl.ItemsSource>
                                                            <MultiBinding Converter="{StaticResource RoomBookingsConverter}">
                                                                <Binding Path="RoomId" />
                                                                <!--  CHANGED from DataContext.Bookings to DataContext.FilteredBookings  -->
                                                                <Binding Path="DataContext.FilteredBookings" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                            </MultiBinding>
                                                        </ItemsControl.ItemsSource>
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <Grid />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border
                                                                    Height="40"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Background="{Binding Status, Converter={StaticResource BookingStatusColorConverter}}"
                                                                    BorderBrush="#9370DB"
                                                                    BorderThickness="1"
                                                                    CornerRadius="3"
                                                                    ToolTip="{Binding GuestID}">
                                                                    <Border.Margin>
                                                                        <MultiBinding Converter="{StaticResource BookingLeftMarginConverter}">
                                                                            <Binding Path="StartDate" />
                                                                            <Binding Path="DataContext.ViewStartDate" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            <Binding ElementName="TimelineBorder" Path="ActualWidth" />
                                                                            <Binding Path="DataContext.DayCount" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                        </MultiBinding>
                                                                    </Border.Margin>
                                                                    <Border.Width>
                                                                        <MultiBinding Converter="{StaticResource BookingWidthConverter}">
                                                                            <Binding Path="." />
                                                                            <Binding Path="DataContext.ViewStartDate" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            <Binding ElementName="TimelineBorder" Path="ActualWidth" />
                                                                            <Binding Path="DataContext.DayCount" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                        </MultiBinding>
                                                                    </Border.Width>
                                                                    <Border.InputBindings>
                                                                        <MouseBinding
                                                                            Command="{Binding DataContext.SelectBookingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                            CommandParameter="{Binding}"
                                                                            Gesture="LeftClick" />
                                                                    </Border.InputBindings>
                                                                    <StackPanel
                                                                        Margin="2"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center">
                                                                        <TextBlock
                                                                            FontSize="10"
                                                                            FontWeight="Bold"
                                                                            TextAlignment="Center"
                                                                            TextTrimming="CharacterEllipsis">
                                                                            <TextBlock.Text>
                                                                                <MultiBinding StringFormat="{}{0} {1}">
                                                                                    <Binding Path="Guest.FirstName" />
                                                                                    <Binding Path="Guest.LastName" />
                                                                                </MultiBinding>
                                                                            </TextBlock.Text>
                                                                        </TextBlock>
                                                                        <TextBlock
                                                                            FontSize="9"
                                                                            FontStyle="Italic"
                                                                            Text="{Binding Guest.Country}"
                                                                            TextAlignment="Center"
                                                                            TextTrimming="CharacterEllipsis" />
                                                                    </StackPanel>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Grid>
                    </ScrollViewer>

                    <!--  Year View  -->
                    <ListView
                        x:Name="BookingsListView"
                        Margin="10"
                        ItemsSource="{Binding FilteredBookings}"
                        SelectedItem="{Binding SelectedBooking}">
                        <ListView.Style>
                            <Style TargetType="ListView">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Width="Auto">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Guest Name" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="Guest.FirstName"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}{0} {1}">
                                                        <Binding Path="Guest.FirstName" />
                                                        <Binding Path="Guest.LastName" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Guest.Country}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Country" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="Guest.Country"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Guest.Email}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Email" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="Guest.Email"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Room.RoomNumber}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Room" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="Room.RoomNumber"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Status}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Status" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="Status"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding StartDate, StringFormat='{}{0:dd/MM/yyyy}'}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Check In Date" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="StartDate"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding EndDate, StringFormat='{}{0:dd/MM/yyyy}'}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Check Out Date" />
                                            <Button
                                                Margin="5,0,0,0"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}"
                                                CommandParameter="EndDate"
                                                Content="⇅" />
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <GridViewColumn Width="180" Header="Check-I/O Status">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding Converter="{StaticResource CheckInStatusConverter}">
                                                        <Binding Path="CheckInTime" />
                                                        <Binding Path="CheckOutTime" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </Grid>
            </Grid>
        </Border>

        <!--  Right Panel  -->
        <StackPanel Grid.Row="1" Grid.Column="2">
            <Border
                Margin="0,0,0,20"
                Padding="15"
                BorderBrush="LightGray"
                BorderThickness="1">
                <StackPanel>
                    <TextBlock
                        Margin="0,0,0,10"
                        FontWeight="Bold"
                        Text="Total Revenue for This Month:" />
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Column="0"
                            FontWeight="Bold"
                            Text="Total:" />
                        <TextBlock
                            Grid.Column="1"
                            FontWeight="Bold"
                            Text="{Binding RevenueThisMonth, StringFormat='{}{0:C}'}" />
                    </Grid>
                </StackPanel>
            </Border>

            <Border
                Margin="0,0,0,20"
                Padding="15"
                BorderBrush="LightGray"
                BorderThickness="1">
                <StackPanel>
                    <TextBlock
                        Margin="0,0,0,10"
                        FontWeight="Bold"
                        Text="Payment Status:" />
                    <TextBlock
                        FontStyle="Italic"
                        Foreground="Gray"
                        Text="Coming soon..." />
                </StackPanel>
            </Border>

            <Border
                Padding="15"
                Background="#FAFAFA"
                BorderBrush="LightGray"
                BorderThickness="1">
                <StackPanel>
                    <TextBlock
                        Margin="0,0,0,10"
                        FontWeight="Bold"
                        Text="Booking Details:" />
                    <ScrollViewer MaxHeight="500" VerticalScrollBarVisibility="Auto">
                        <ScrollViewer.Style>
                            <Style TargetType="ScrollViewer">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedBooking}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ScrollViewer.Style>
                        <StackPanel>
                            <!--  Guest Section  -->
                            <TextBlock
                                Margin="0,0,0,5"
                                FontWeight="SemiBold"
                                Foreground="#555"
                                Text="Guest Information"
                                TextDecorations="Underline" />
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Name:" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    TextWrapping="Wrap">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0} {1}">
                                            <Binding Path="SelectedBooking.Guest.FirstName" />
                                            <Binding Path="SelectedBooking.Guest.LastName" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Email:" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Guest.Email}"
                                    TextWrapping="Wrap" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Phone:" />
                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Guest.PhoneNumber}" />

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Country:" />
                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Guest.Country}" />
                            </Grid>

                            <!--  Room Section  -->
                            <TextBlock
                                Margin="0,0,0,5"
                                FontWeight="SemiBold"
                                Foreground="#555"
                                Text="Room Information"
                                TextDecorations="Underline" />
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Room #:" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Room.RoomNumber}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Size:" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Room.RoomSize}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Floor:" />
                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.Room.Floor}" />
                            </Grid>

                            <!--  Booking Section  -->
                            <TextBlock
                                Margin="0,0,0,5"
                                FontWeight="SemiBold"
                                Foreground="#555"
                                Text="Booking Status"
                                TextDecorations="Underline" />
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Status:" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    FontWeight="Bold"
                                    Text="{Binding SelectedBooking.Status}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Booking #:" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    FontWeight="Bold"
                                    Foreground="#6B8CBF"
                                    Text="{Binding SelectedBooking.BookingNumber}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Dates:" />
                                <TextBlock Grid.Row="2" Grid.Column="1">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0:dd/MM} - {1:dd/MM/yyyy}">
                                            <Binding Path="SelectedBooking.StartDate" />
                                            <Binding Path="SelectedBooking.EndDate" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Check-in:" />
                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.CheckInTime, TargetNullValue='Not Checked In', StringFormat='{}{0:HH:mm}'}" />

                                <TextBlock
                                    Grid.Row="4"
                                    Grid.Column="0"
                                    Margin="0,0,10,2"
                                    FontWeight="SemiBold"
                                    Text="Check-out:" />
                                <TextBlock
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Text="{Binding SelectedBooking.CheckOutTime, TargetNullValue='Not Checked Out', StringFormat='{}{0:HH:mm}'}" />
                            </Grid>

                            <!--  Check-In/Check-Out Actions  -->
                            <StackPanel Margin="0,20,0,0" Orientation="Vertical">
                                <Button
                                    Height="40"
                                    Margin="0,0,0,10"
                                    Background="#90EE90"
                                    BorderBrush="#32CD32"
                                    BorderThickness="2"
                                    Command="{Binding CheckInBookingCommand}"
                                    Content="✓ Check In Guest"
                                    FontSize="14"
                                    FontWeight="SemiBold">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Opacity" Value="0.5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <!--  Cancel Booking Button  -->
                                <Button
                                    Height="40"
                                    Margin="0,0,0,10"
                                    Background="#DC3545"
                                    BorderBrush="#C82333"
                                    BorderThickness="2"
                                    Command="{Binding CancelBookingCommand}"
                                    Content="❌ Cancel Booking"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Foreground="White">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedBooking.Status}" Value="Pending">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SelectedBooking.Status}" Value="Confirmed">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Opacity" Value="0.5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button
                                    Height="40"
                                    Background="#FFB6C1"
                                    BorderBrush="#FF69B4"
                                    BorderThickness="2"
                                    Command="{Binding CheckOutBookingCommand}"
                                    Content="✓ Check Out Guest"
                                    FontSize="14"
                                    FontWeight="SemiBold">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Opacity" Value="0.5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                    <TextBlock
                        FontStyle="Italic"
                        Foreground="Gray"
                        Text="Select a booking to view details.">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedBooking}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</UserControl>