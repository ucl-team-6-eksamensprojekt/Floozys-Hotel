<UserControl
    x:Class="Floozys_Hotel.Views.BookingOverviewView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Floozys_Hotel.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="clr-namespace:Floozys_Hotel.Converters"
    xmlns:core="clr-namespace:Floozys_Hotel.Core"
    d:DesignHeight="600"
    d:DesignWidth="1000"
    mc:Ignorable="d">

    <UserControl.Resources>
        <!-- Proxy to capture DataContext for GridViewColumns -->
        <core:BindingProxy x:Key="DataContextProxy" Data="{Binding}" />

        <!-- Her definerer jeg mine converters, så jeg kan bruge dem i XAML'en længere nede. -->
        <converters:BookingLeftMarginConverter x:Key="BookingLeftMarginConverter" />
        <converters:BookingWidthConverter x:Key="BookingWidthConverter" />
        <converters:RoomBookingsConverter x:Key="RoomBookingsConverter" />
        <converters:DateHeaderConverter x:Key="DateHeaderConverter" />
        <converters:BookingStatusColorConverter x:Key="BookingStatusColorConverter"/>
        <converters:CheckInStatusConverter x:Key="CheckInStatusConverter"/>
    </UserControl.Resources>

    <!-- Jeg bruger et Grid til at opdele skærmen i 3 kolonner: Header/Venstre, Kalender/Midte, Detaljer/Højre. -->
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="300" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <TextBlock
            Grid.Row="0"
            Grid.Column="0"
            Margin="0,0,0,30"
            VerticalAlignment="Center"
            FontSize="30"
            FontWeight="ExtraBold"
            Text="Booking Overview" />

        <!-- Knappen til at oprette en ny booking. Den binder til NewBookingCommand i ViewModelen. -->
        <Button
            Command="{Binding NewBookingCommand}"
            Grid.Row="0"
            Grid.Column="2"
            Width="180"
            Height="50"
            Margin="0,0,0,30"
            HorizontalAlignment="Right"
            Background="#90EE90"
            BorderBrush="#32CD32"
            BorderThickness="2"
            Content="New booking"
            FontSize="16"
            FontWeight="SemiBold"
            Foreground="Black" />

        <!--  Calendar  -->
        <!-- Dette er hovedområdet for kalenderen. -->
        <Border
            Grid.Row="1"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="0,0,20,0"
            BorderBrush="LightGray"
            BorderThickness="1">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Controls  -->
                <!-- Her er knapperne til at navigere (frem/tilbage) og skifte visning (Uge/Måned/År). -->
                <Grid Grid.Row="0" Margin="15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Søgefeltet binder til SearchText. UpdateSourceTrigger=PropertyChanged gør, at søgningen sker mens man skriver. -->
                    <TextBox
                        Grid.Column="0"
                        Width="200"
                        Height="35"
                        FontSize="14"
                        Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                        VerticalContentAlignment="Center"
                        Padding="10,0">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Setter Property="Foreground" Value="Black"/>
                                <Style.Triggers>
                                    <Trigger Property="Text" Value="">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <VisualBrush AlignmentX="Left" AlignmentY="Center" Stretch="None">
                                                    <VisualBrush.Visual>
                                                        <TextBlock Text="🔍 Search by Guest..." Foreground="Gray" Margin="10,0,0,0"/>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <StackPanel Grid.Column="1" HorizontalAlignment="Center" Orientation="Horizontal">
                        <!-- Knapper til at gå frem og tilbage i tid. -->
                        <Button Command="{Binding PreviousMonthCommand}" Width="30" Height="30" Margin="0,0,10,0" Content="&lt;" FontSize="16" />
                        <TextBlock VerticalAlignment="Center" FontSize="18" FontWeight="SemiBold" Text="{Binding CurrentMonthDisplay}" />
                        <Button Command="{Binding NextMonthCommand}" Width="30" Height="30" Margin="10,0,0,0" Content="&gt;" FontSize="16" />
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <!-- Knapper til at skifte mellem Uge, Måned og År. -->
                        <Button Command="{Binding SetWeekViewCommand}" Width="60" Height="30" Margin="0,0,2,0" Content="Week">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Week">
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Background" Value="#E0E0E0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button Command="{Binding SetMonthViewCommand}" Width="60" Height="30" Margin="0,0,2,0" Content="Month">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Month">
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Background" Value="#E0E0E0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button Command="{Binding SetYearViewCommand}" Width="60" Height="30" Content="Year">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Background" Value="#E0E0E0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Grid>

                <!--  Content  -->
                <Grid Grid.Row="1">
                    <!-- Calendar View -->
                    <!-- Her bruger jeg en ScrollViewer, så man kan scrolle hvis der er mange værelser. -->
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                        <ScrollViewer.Style>
                            <Style TargetType="ScrollViewer">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ScrollViewer.Style>
                        
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Room Header -->
                            <!-- Overskrift til venstre kolonne. -->
                            <Border Grid.Row="0" Grid.Column="0" BorderBrush="Gray" BorderThickness="0,0,1,1" Background="#F0F0F0" Height="30">
                                <TextBlock Text="Rooms" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold"/>
                            </Border>

                            <!-- Days Header - Responsive -->
                            <!-- Her viser jeg datoerne (1, 2, 3...) eller ugedagene i toppen. ItemsControl laver en liste baseret på DaysInMonth. -->
                            <ItemsControl Grid.Row="0" Grid.Column="1" ItemsSource="{Binding DaysInMonth}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Rows="1" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="LightGray" BorderThickness="0,0,1,1" Background="White" Height="30">
                                            <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Rooms -->
                            <!-- Her lister jeg alle værelserne nedad. For hvert værelse laver jeg en række. -->
                            <ItemsControl Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" ItemsSource="{Binding Rooms}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="150"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="50"/>
                                            </Grid.RowDefinitions>

                                            <Border Grid.Column="0" BorderBrush="LightGray" BorderThickness="0,0,1,1" Background="White">
                                                <StackPanel VerticalAlignment="Center" Margin="10,0">
                                                    <TextBlock Text="{Binding RoomNumber}" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding RoomSize}" FontSize="10" Foreground="Gray"/>
                                                </StackPanel>
                                            </Border>

                                            <Border Grid.Column="1" BorderBrush="LightGray" BorderThickness="0,0,0,1" x:Name="TimelineBorder">
                                                <Grid>
                                                    <!-- Background Grid Lines -->
                                                    <!-- Her tegner jeg de lodrette streger, der adskiller dagene. -->
                                                    <ItemsControl ItemsSource="{Binding DataContext.DaysInMonth, RelativeSource={RelativeSource AncestorType=UserControl}}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border BorderBrush="#F5F5F5" BorderThickness="0,0,1,0" Height="50"/>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Bookings Layer -->
                                                    <ItemsControl>
                                                        <ItemsControl.ItemsSource>
                                                            <MultiBinding Converter="{StaticResource RoomBookingsConverter}">
                                                                <Binding Path="RoomId" />
                                                                <Binding Path="DataContext.Bookings" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                            </MultiBinding>
                                                        </ItemsControl.ItemsSource>
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <Grid />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Background="{Binding Status, Converter={StaticResource BookingStatusColorConverter}}" BorderBrush="#9370DB" BorderThickness="1" CornerRadius="3" Height="40" VerticalAlignment="Top" HorizontalAlignment="Left" ToolTip="{Binding GuestID}">
                                                                    <Border.Margin>
                                                                        <MultiBinding Converter="{StaticResource BookingLeftMarginConverter}">
                                                                            <Binding Path="StartDate" />
                                                                            <Binding Path="DataContext.ViewStartDate" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            <Binding Path="ActualWidth" ElementName="TimelineBorder" />
                                                                            <Binding Path="DataContext.DayCount" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                        </MultiBinding>
                                                                    </Border.Margin>
                                                                    <Border.Width>
                                                                        <MultiBinding Converter="{StaticResource BookingWidthConverter}">
                                                                            <Binding Path="." />
                                                                            <Binding Path="DataContext.ViewStartDate" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            <Binding Path="ActualWidth" ElementName="TimelineBorder" />
                                                                            <Binding Path="DataContext.DayCount" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                        </MultiBinding>
                                                                    </Border.Width>
                                                                    <Border.InputBindings>
                                                                        <MouseBinding Gesture="LeftClick" Command="{Binding DataContext.SelectBookingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                                                    </Border.InputBindings>
                                                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Margin="2">
                                                                        <TextBlock FontWeight="Bold" FontSize="10" TextTrimming="CharacterEllipsis" TextAlignment="Center">
                                                                            <TextBlock.Text>
                                                                                <MultiBinding StringFormat="{}{0} {1}">
                                                                                    <Binding Path="Guest.FirstName" />
                                                                                    <Binding Path="Guest.LastName" />
                                                                                </MultiBinding>
                                                                            </TextBlock.Text>
                                                                        </TextBlock>
                                                                        <TextBlock Text="{Binding Guest.Country}" FontSize="9" FontStyle="Italic" TextTrimming="CharacterEllipsis" TextAlignment="Center"/>
                                                                    </StackPanel>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Grid>
                    </ScrollViewer>
                    
                    <!-- Year View -->
                    <ListView x:Name="BookingsListView" ItemsSource="{Binding FilteredBookings}" SelectedItem="{Binding SelectedBooking}" Margin="10">
                        <ListView.Style>
                            <Style TargetType="ListView">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ViewDuration}" Value="Year">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>
                        <ListView.View>
                            <GridView>

                                <!-- Sortable Guest Name -->
                                <GridViewColumn Width="Auto">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Guest Name" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="Guest.FirstName"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}{0} {1}">
                                                        <Binding Path="Guest.FirstName" />
                                                        <Binding Path="Guest.LastName" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <!-- Sortable Country -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Guest.Country}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Country" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="Guest.Country"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <!-- Sortable Email -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Guest.Email}">
                                     <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Email" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="Guest.Email"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>
                                
                                <!-- Sortable Room -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Room.RoomNumber}">
                                    <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Room" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="Room.RoomNumber"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <!-- Sortable Status -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Status}">
                                     <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Status" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="Status"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <!-- Sortable Start Date -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding StartDate, StringFormat='{}{0:dd/MM/yyyy}'}">
                                     <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Check In Date" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="StartDate"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>
                                
                                <!-- Sortable End Date -->
                                <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding EndDate, StringFormat='{}{0:dd/MM/yyyy}'}">
                                     <GridViewColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Check Out Date" VerticalAlignment="Center"/>
                                            <Button Content="⇅" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" 
                                                    Command="{Binding Data.SortCommand, Source={StaticResource DataContextProxy}}" 
                                                    CommandParameter="EndDate"/>
                                        </StackPanel>
                                    </GridViewColumn.Header>
                                </GridViewColumn>

                                <!-- Check-In/Out Status Text (Combined) -->
                                <GridViewColumn Width="180" Header="Check-I/O Status">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding Converter="{StaticResource CheckInStatusConverter}">
                                                        <Binding Path="CheckInTime" />
                                                        <Binding Path="CheckOutTime" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </Grid>
            </Grid>
        </Border>

        <!--  Right Panel  -->
        <StackPanel Grid.Row="1" Grid.Column="2">
            <Border Margin="0,0,0,20" Padding="15" BorderBrush="LightGray" BorderThickness="1">
                <StackPanel>
                    <TextBlock Text="Total Revenue for This Month:" FontWeight="Bold" Margin="0,0,0,10"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Total:" FontWeight="Bold" Grid.Column="0"/>
                        <TextBlock Text="{Binding RevenueThisMonth, StringFormat='{}{0:C}'}" FontWeight="Bold" Grid.Column="1"/>
                    </Grid>
                </StackPanel>
            </Border>

            <Border Padding="15" BorderBrush="LightGray" BorderThickness="1" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock Text="Payment Status:" FontWeight="Bold" Margin="0,0,0,10"/>
                    <TextBlock Text="Coming soon..." FontStyle="Italic" Foreground="Gray"/>
                </StackPanel>
            </Border>

            <Border Padding="15" BorderBrush="LightGray" BorderThickness="1" Background="#FAFAFA">
                <StackPanel>
                    <TextBlock Text="Booking Details:" FontWeight="Bold" Margin="0,0,0,10"/>
                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="500">
                            <ScrollViewer.Style>
                                <Style TargetType="ScrollViewer">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedBooking}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ScrollViewer.Style>
                            <StackPanel>
                                <!-- Guest Section -->
                                <TextBlock Text="Guest Information" FontWeight="SemiBold" TextDecorations="Underline" Margin="0,0,0,5" Foreground="#555"/>
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" TextWrapping="Wrap">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0} {1}">
                                                <Binding Path="SelectedBooking.Guest.FirstName" />
                                                <Binding Path="SelectedBooking.Guest.LastName" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Email:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedBooking.Guest.Email}" TextWrapping="Wrap"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Phone:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedBooking.Guest.PhoneNumber}"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Country:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedBooking.Guest.Country}"/>
                                </Grid>

                                <!-- Room Section -->
                                <TextBlock Text="Room Information" FontWeight="SemiBold" TextDecorations="Underline" Margin="0,0,0,5" Foreground="#555"/>
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Room #:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedBooking.Room.RoomNumber}"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Size:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedBooking.Room.RoomSize}"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Floor:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedBooking.Room.Floor}"/>
                                </Grid>

                                <!-- Booking Section -->
                                <TextBlock Text="Booking Status" FontWeight="SemiBold" TextDecorations="Underline" Margin="0,0,0,5" Foreground="#555"/>
                                <Grid>
                                     <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Status:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedBooking.Status}" FontWeight="Bold"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Dates:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1">
                                        <TextBlock.Text>
                                             <MultiBinding StringFormat="{}{0:dd/MM} - {1:dd/MM/yyyy}">
                                                <Binding Path="SelectedBooking.StartDate" />
                                                <Binding Path="SelectedBooking.EndDate" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                     
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Check-in:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedBooking.CheckInTime, TargetNullValue='Not Checked In', StringFormat='{}{0:HH:mm}'}"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Check-out:" FontWeight="SemiBold" Margin="0,0,10,2"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedBooking.CheckOutTime, TargetNullValue='Not Checked Out', StringFormat='{}{0:HH:mm}'}"/>
                                </Grid>
                            </StackPanel>
                        </ScrollViewer>
                    <TextBlock Text="Select a booking to view details." FontStyle="Italic" Foreground="Gray">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedBooking}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</UserControl>